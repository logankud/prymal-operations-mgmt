<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <h1>Production Management Dashboard</h1>

    <!-- Tabs for Navigation -->
    <div style="display: flex; gap: 20px; border-bottom: 1px solid #ccc; padding: 10px 0; margin-bottom: 20px;">
        <a href="{{ url_for('manufacturing_orders') }}" 
           class="{{ 'active' if request.path == url_for('manufacturing_orders') else '' }}">Manufacturing Orders</a>
        <a href="{{ url_for('products') }}" 
           class="{{ 'active' if request.path == url_for('products') else '' }}">Products</a>
        <a href="{{ url_for('categories') }}" 
           class="{{ 'active' if request.path == url_for('categories') else '' }}">Categories</a>
        <a href="{{ url_for('flavors') }}" 
           class="{{ 'active' if request.path == url_for('flavors') else '' }}">Flavors</a>
        <a href="{{ url_for('sizes') }}" 
           class="{{ 'active' if request.path == url_for('sizes') else '' }}">Sizes</a>
        <a href="{{ url_for('vendors') }}" 
           class="{{ 'active' if request.path == url_for('vendors') else '' }}">Vendors</a>
        <a href="{{ url_for('raw_materials') }}" 
           class="{{ 'active' if request.path == url_for('raw_materials') else '' }}">Raw Materials</a>
        <a href="{{ url_for('recipes') }}" 
           class="{{ 'active' if request.path == url_for('recipes') else '' }}">Recipes</a>
    </div>

    <!-- Add New Recipe Button -->
    <div style="margin-bottom: 20px;">
        <a href="{{ url_for('add_recipe') }}">
            <button>Add Recipe</button>
        </a>
    </div>

    <!-- Recipes Table -->
    <table border="1" cellpadding="5" cellspacing="0">
        <thead>
            <tr>
                <th>Product</th>
                <th>Raw Material</th>
                <th>Quantity</th>
                <th>Unit</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for recipe in recipes %}
                <tr>
                    <td rowspan="{{ recipe.raw_materials|length }}">{{ recipe.product_name }}</td>
                    {% for raw_material in recipe.raw_materials %}
                        {% if not loop.first %}
                        <tr>
                        {% endif %}
                        <td>{{ raw_material.name }}</td>
                        <td>{{ "%.2f" | format(raw_material.quantity) }}</td>
                        <td>{{ raw_material.unit }}</td>
                        {% if loop.first %}
                            <td rowspan="{{ recipe.raw_materials|length }}">
                                <a href="{{ url_for('edit_recipe', id=recipe.id) }}">
                                    <button>Edit</button>
                                </a>
                                <form action="{{ url_for('delete_recipe', id=recipe.id) }}" method="POST" style="display:inline;">
                                    <button type="submit" onclick="return confirm('Are you sure you want to delete this recipe?');">Delete</button>
                                </form>
                            </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
